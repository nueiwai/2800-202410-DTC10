<!-- drawer component -->
<div id="availableBatteriesCard" class="invisible">
  <p class="font-bold text-center py-2">Available Batteries</p>
  <div class="grid grid-cols-1 grid-rows-1 p-4 gap-4">
    <button class="p-4 rounded-lg cursor-pointer bg-buttonBg">
      <div class="flex justify-center items-center p-2 mx-auto mb-2 rounded-full w-[48px] h-[48px] max-w-[48px] max-h-[48px]">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-drone" width="36" height="36" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <path d="M10 10h4v4h-4z" />
          <path d="M10 10l-3.5 -3.5" />
          <path d="M9.96 6a3.5 3.5 0 1 0 -3.96 3.96" />
          <path d="M14 10l3.5 -3.5" />
          <path d="M18 9.96a3.5 3.5 0 1 0 -3.96 -3.96" />
          <path d="M14 14l3.5 3.5" />
          <path d="M14.04 18a3.5 3.5 0 1 0 3.96 -3.96" />
          <path d="M10 14l-3.5 3.5" />
          <path d="M6 14.04a3.5 3.5 0 1 0 3.96 3.96" />
        </svg>
      </div>
    </button>
    <div class="flex justify-center">
      <div class="flex space-x-2 w-64 py-3">
        <button class="bg-white text-black py-2 px-4 rounded-lg text-lg flex-1">Cancel</button>
        <button id="available-battery-next-btn" class="bg-black text-white py-2 px-4 rounded-lg text-lg flex-1">Next</button>
      </div>
    </div>
  </div>
</div>

<script>
  $("#available-battery-next-btn").click(async () => {
    let paymentMethods = $("#paymentMethods");
    let availableCards = $("#availableCards");

    $("#availableBatteriesCard").removeClass("slide-in-left").addClass("slide-out-left");
    paymentMethods.css("transform", "translateX(-100%)");
    paymentMethods.addClass("slide-in-left");

    paymentInfo = await fetch("/PaymentInfo").then((res) => res.json());

    paymentInfo.forEach((paymentMethod) => {

      if (paymentMethod.cardNumber.length < 4) return paymentMethod.cardNumber;

      const starQuantity = paymentMethod.cardNumber.length - 4;
      const stars = "*".repeat(starQuantity);
      const lastFourDigits = paymentMethod.cardNumber.slice(-4);
      const cardNumber = `${stars}${lastFourDigits}`
      
      element = `
      <button id="${paymentMethod._id}" class="credit-card cursor-pointer flex w-11/12 bg-white rounded-xl shadow p-2 mx-auto focus:ring-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="mr-[20px] self-center icon icon-tabler icon-tabler-credit-card" width="35" height="35" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M3 5m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z"></path>
          <path d="M3 10l18 0"></path>
          <path d="M7 15l.01 0"></path>
          <path d="M11 15l2 0"></path>
        </svg>
        <div class="payment-info-card">
          <strong>${paymentMethod.cardType}</strong>
          <p>${cardNumber}</p>
          <p>${paymentMethod.expiryDate}</p>
        </div>
      </button>
      `;
      availableCards.append(element);
      paymentMethods.removeClass("slide-in-left");
      paymentMethods.addClass("slide-in-left");
    });
    $("#main-menu-drawer").height($("#paymentMethods").height() + 50 + "px");
  });
</script>
